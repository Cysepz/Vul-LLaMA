07/06/2025 23:00:06 - INFO - root -   ====================================================================================================
07/06/2025 23:00:06 - INFO - root -   ðŸ”„ðŸ”„ðŸ”„ðŸ”„ðŸ”„  NEW RUN STARTED  ðŸ”„ðŸ”„ðŸ”„ðŸ”„ðŸ”„
07/06/2025 23:00:06 - INFO - root -   ====================================================================================================

07/06/2025 23:00:06 - INFO - __main__ -   CUDA STATUS = True
07/06/2025 23:00:06 - INFO - __main__ -   device: cuda, n_gpu: 1
07/06/2025 23:00:07 - INFO - __main__ -   Loading tokenizer...
07/06/2025 23:00:07 - INFO - __main__ -   Loading model...
07/06/2025 23:00:43 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='./data/train.json', eval_data_file='./data/eval.json', test_data_file='./data/test.json', saved_model_dir='./saved_model', mode='train', tokenizer='non_pretrained', model_name='vulllama_b4', reasoning_method='attention', get_line_attn_mode='sum', do_local_explanation=True, do_sorting_by_line_scores=True, effort_at_n_percent_recall=0.2, recall_at_n_percent_loc=0.01, batch_size=16, gradient_accumulation_steps=1, learning_rate=0.0001, weight_decay=0.0, adam_epsilon=0.001, max_grad_norm=1.0, max_steps=-1, epochs=18, device=device(type='cuda'), test_output_path='./vul_llama/experiment/baseline/pred_result_from_main.csv', log_file='./vul_llama/train_logs/vulllama_train_b4.log', n_gpu=1)
07/06/2025 23:00:48 - INFO - __main__ -   ***** Running training *****
07/06/2025 23:00:48 - INFO - __main__ -     Num examples = 16000
07/06/2025 23:00:48 - INFO - __main__ -     Num Epochs = 18
07/06/2025 23:00:48 - INFO - __main__ -     Batch size = 16
07/06/2025 23:00:48 - INFO - __main__ -     Gradient Accumulation steps = 1
07/06/2025 23:00:48 - INFO - __main__ -     Total optimization steps = 18000
07/06/2025 23:00:48 - INFO - __main__ -   === Epoch 1/18 ===
07/07/2025 01:31:33 - INFO - __main__ -   ***** Running evaluation *****
07/07/2025 01:31:33 - INFO - __main__ -     Num examples = 2000
07/07/2025 01:31:33 - INFO - __main__ -     Batch size = 16
07/07/2025 01:36:12 - INFO - __main__ -   ***** Eval results *****
07/07/2025 01:36:12 - INFO - __main__ -     eval_accuracy = 0.5095
07/07/2025 01:36:12 - INFO - __main__ -     eval_f1 = 0.0219
07/07/2025 01:36:12 - INFO - __main__ -     eval_precision = 1.0
07/07/2025 01:36:12 - INFO - __main__ -     eval_recall = 0.0111
07/07/2025 01:36:12 - INFO - __main__ -     eval_threshold = 0.5
07/07/2025 01:36:12 - INFO - __main__ -     ********************
07/07/2025 01:36:12 - INFO - __main__ -     Best eval_f1: 0.0219
07/07/2025 01:36:12 - INFO - __main__ -     ********************
07/07/2025 01:36:54 - INFO - __main__ -   Saved full checkpoint to ./saved_model/checkpoint-best-f1/vulllama_b4_non_pretrained.pt
07/07/2025 01:36:54 - INFO - __main__ -   Epoch 1 finished. Avg loss=0.6866
07/07/2025 01:36:54 - INFO - __main__ -   === Epoch 2/18 ===
07/07/2025 04:07:45 - INFO - __main__ -   ***** Running evaluation *****
07/07/2025 04:07:45 - INFO - __main__ -     Num examples = 2000
07/07/2025 04:07:45 - INFO - __main__ -     Batch size = 16
07/07/2025 04:12:24 - INFO - __main__ -   ***** Eval results *****
07/07/2025 04:12:24 - INFO - __main__ -     eval_accuracy = 0.6755
07/07/2025 04:12:24 - INFO - __main__ -     eval_f1 = 0.5321
07/07/2025 04:12:24 - INFO - __main__ -     eval_precision = 0.9342
07/07/2025 04:12:24 - INFO - __main__ -     eval_recall = 0.372
07/07/2025 04:12:24 - INFO - __main__ -     eval_threshold = 0.5
07/07/2025 04:12:24 - INFO - __main__ -     ********************
07/07/2025 04:12:24 - INFO - __main__ -     Best eval_f1: 0.5321
07/07/2025 04:12:24 - INFO - __main__ -     ********************
07/07/2025 04:13:07 - INFO - __main__ -   Saved full checkpoint to ./saved_model/checkpoint-best-f1/vulllama_b4_non_pretrained.pt
07/07/2025 04:13:07 - INFO - __main__ -   Epoch 2 finished. Avg loss=0.5263
07/07/2025 04:13:07 - INFO - __main__ -   === Epoch 3/18 ===
07/07/2025 06:43:50 - INFO - __main__ -   ***** Running evaluation *****
07/07/2025 06:43:50 - INFO - __main__ -     Num examples = 2000
07/07/2025 06:43:50 - INFO - __main__ -     Batch size = 16
07/07/2025 06:48:29 - INFO - __main__ -   ***** Eval results *****
07/07/2025 06:48:29 - INFO - __main__ -     eval_accuracy = 0.6265
07/07/2025 06:48:29 - INFO - __main__ -     eval_f1 = 0.4048
07/07/2025 06:48:29 - INFO - __main__ -     eval_precision = 0.9658
07/07/2025 06:48:29 - INFO - __main__ -     eval_recall = 0.256
07/07/2025 06:48:29 - INFO - __main__ -     eval_threshold = 0.5
07/07/2025 06:48:29 - INFO - __main__ -   Epoch 3 finished. Avg loss=0.4235
07/07/2025 06:48:29 - INFO - __main__ -   === Epoch 4/18 ===
07/07/2025 09:19:16 - INFO - __main__ -   ***** Running evaluation *****
07/07/2025 09:19:16 - INFO - __main__ -     Num examples = 2000
07/07/2025 09:19:16 - INFO - __main__ -     Batch size = 16
07/07/2025 09:23:54 - INFO - __main__ -   ***** Eval results *****
07/07/2025 09:23:54 - INFO - __main__ -     eval_accuracy = 0.798
07/07/2025 09:23:54 - INFO - __main__ -     eval_f1 = 0.7534
07/07/2025 09:23:54 - INFO - __main__ -     eval_precision = 0.9551
07/07/2025 09:23:54 - INFO - __main__ -     eval_recall = 0.622
07/07/2025 09:23:54 - INFO - __main__ -     eval_threshold = 0.5
07/07/2025 09:23:54 - INFO - __main__ -     ********************
07/07/2025 09:23:54 - INFO - __main__ -     Best eval_f1: 0.7534
07/07/2025 09:23:54 - INFO - __main__ -     ********************
07/07/2025 09:24:41 - INFO - __main__ -   Saved full checkpoint to ./saved_model/checkpoint-best-f1/vulllama_b4_non_pretrained.pt
07/07/2025 09:24:41 - INFO - __main__ -   Epoch 4 finished. Avg loss=0.3468
07/07/2025 09:24:41 - INFO - __main__ -   === Epoch 5/18 ===
07/07/2025 11:55:28 - INFO - __main__ -   ***** Running evaluation *****
07/07/2025 11:55:28 - INFO - __main__ -     Num examples = 2000
07/07/2025 11:55:28 - INFO - __main__ -     Batch size = 16
07/07/2025 12:00:06 - INFO - __main__ -   ***** Eval results *****
07/07/2025 12:00:06 - INFO - __main__ -     eval_accuracy = 0.7605
07/07/2025 12:00:06 - INFO - __main__ -     eval_f1 = 0.6928
07/07/2025 12:00:06 - INFO - __main__ -     eval_precision = 0.9524
07/07/2025 12:00:06 - INFO - __main__ -     eval_recall = 0.5444
07/07/2025 12:00:06 - INFO - __main__ -     eval_threshold = 0.5
07/07/2025 12:00:06 - INFO - __main__ -   Epoch 5 finished. Avg loss=0.3145
07/07/2025 12:00:06 - INFO - __main__ -   === Epoch 6/18 ===
07/07/2025 14:30:49 - INFO - __main__ -   ***** Running evaluation *****
07/07/2025 14:30:49 - INFO - __main__ -     Num examples = 2000
07/07/2025 14:30:49 - INFO - __main__ -     Batch size = 16
07/07/2025 14:35:27 - INFO - __main__ -   ***** Eval results *****
07/07/2025 14:35:27 - INFO - __main__ -     eval_accuracy = 0.8485
07/07/2025 14:35:27 - INFO - __main__ -     eval_f1 = 0.8277
07/07/2025 14:35:27 - INFO - __main__ -     eval_precision = 0.9492
07/07/2025 14:35:27 - INFO - __main__ -     eval_recall = 0.7339
07/07/2025 14:35:27 - INFO - __main__ -     eval_threshold = 0.5
07/07/2025 14:35:27 - INFO - __main__ -     ********************
07/07/2025 14:35:27 - INFO - __main__ -     Best eval_f1: 0.8277
07/07/2025 14:35:27 - INFO - __main__ -     ********************
07/07/2025 14:36:13 - INFO - __main__ -   Saved full checkpoint to ./saved_model/checkpoint-best-f1/vulllama_b4_non_pretrained.pt
07/07/2025 14:36:13 - INFO - __main__ -   Epoch 6 finished. Avg loss=0.2615
07/07/2025 14:36:13 - INFO - __main__ -   === Epoch 7/18 ===
07/07/2025 17:07:01 - INFO - __main__ -   ***** Running evaluation *****
07/07/2025 17:07:01 - INFO - __main__ -     Num examples = 2000
07/07/2025 17:07:01 - INFO - __main__ -     Batch size = 16
07/07/2025 17:11:39 - INFO - __main__ -   ***** Eval results *****
07/07/2025 17:11:39 - INFO - __main__ -     eval_accuracy = 0.8245
07/07/2025 17:11:39 - INFO - __main__ -     eval_f1 = 0.7922
07/07/2025 17:11:39 - INFO - __main__ -     eval_precision = 0.9598
07/07/2025 17:11:39 - INFO - __main__ -     eval_recall = 0.6744
07/07/2025 17:11:39 - INFO - __main__ -     eval_threshold = 0.5
07/07/2025 17:11:39 - INFO - __main__ -   Epoch 7 finished. Avg loss=0.2297
07/07/2025 17:11:39 - INFO - __main__ -   === Epoch 8/18 ===
07/07/2025 19:42:21 - INFO - __main__ -   ***** Running evaluation *****
07/07/2025 19:42:21 - INFO - __main__ -     Num examples = 2000
07/07/2025 19:42:21 - INFO - __main__ -     Batch size = 16
07/07/2025 19:46:59 - INFO - __main__ -   ***** Eval results *****
07/07/2025 19:46:59 - INFO - __main__ -     eval_accuracy = 0.918
07/07/2025 19:46:59 - INFO - __main__ -     eval_f1 = 0.9143
07/07/2025 19:46:59 - INFO - __main__ -     eval_precision = 0.949
07/07/2025 19:46:59 - INFO - __main__ -     eval_recall = 0.8821
07/07/2025 19:46:59 - INFO - __main__ -     eval_threshold = 0.5
07/07/2025 19:46:59 - INFO - __main__ -     ********************
07/07/2025 19:46:59 - INFO - __main__ -     Best eval_f1: 0.9143
07/07/2025 19:46:59 - INFO - __main__ -     ********************
07/07/2025 19:47:46 - INFO - __main__ -   Saved full checkpoint to ./saved_model/checkpoint-best-f1/vulllama_b4_non_pretrained.pt
07/07/2025 19:47:46 - INFO - __main__ -   Epoch 8 finished. Avg loss=0.2018
07/07/2025 19:47:46 - INFO - __main__ -   === Epoch 9/18 ===
07/07/2025 22:18:28 - INFO - __main__ -   ***** Running evaluation *****
07/07/2025 22:18:28 - INFO - __main__ -     Num examples = 2000
07/07/2025 22:18:28 - INFO - __main__ -     Batch size = 16
07/07/2025 22:23:06 - INFO - __main__ -   ***** Eval results *****
07/07/2025 22:23:06 - INFO - __main__ -     eval_accuracy = 0.8155
07/07/2025 22:23:06 - INFO - __main__ -     eval_f1 = 0.7815
07/07/2025 22:23:06 - INFO - __main__ -     eval_precision = 0.9469
07/07/2025 22:23:06 - INFO - __main__ -     eval_recall = 0.6653
07/07/2025 22:23:06 - INFO - __main__ -     eval_threshold = 0.5
07/07/2025 22:23:06 - INFO - __main__ -   Epoch 9 finished. Avg loss=0.1884
07/07/2025 22:23:06 - INFO - __main__ -   === Epoch 10/18 ===
07/08/2025 00:53:48 - INFO - __main__ -   ***** Running evaluation *****
07/08/2025 00:53:48 - INFO - __main__ -     Num examples = 2000
07/08/2025 00:53:48 - INFO - __main__ -     Batch size = 16
07/08/2025 00:58:26 - INFO - __main__ -   ***** Eval results *****
07/08/2025 00:58:26 - INFO - __main__ -     eval_accuracy = 0.9375
07/08/2025 00:58:26 - INFO - __main__ -     eval_f1 = 0.9377
07/08/2025 00:58:26 - INFO - __main__ -     eval_precision = 0.9279
07/08/2025 00:58:26 - INFO - __main__ -     eval_recall = 0.9476
07/08/2025 00:58:26 - INFO - __main__ -     eval_threshold = 0.5
07/08/2025 00:58:26 - INFO - __main__ -     ********************
07/08/2025 00:58:26 - INFO - __main__ -     Best eval_f1: 0.9377
07/08/2025 00:58:26 - INFO - __main__ -     ********************
07/08/2025 00:59:06 - INFO - __main__ -   Saved full checkpoint to ./saved_model/checkpoint-best-f1/vulllama_b4_non_pretrained.pt
07/08/2025 00:59:06 - INFO - __main__ -   Epoch 10 finished. Avg loss=0.17
07/08/2025 00:59:06 - INFO - __main__ -   === Epoch 11/18 ===
07/08/2025 03:29:47 - INFO - __main__ -   ***** Running evaluation *****
07/08/2025 03:29:47 - INFO - __main__ -     Num examples = 2000
07/08/2025 03:29:47 - INFO - __main__ -     Batch size = 16
07/08/2025 03:34:26 - INFO - __main__ -   ***** Eval results *****
07/08/2025 03:34:26 - INFO - __main__ -     eval_accuracy = 0.9295
07/08/2025 03:34:26 - INFO - __main__ -     eval_f1 = 0.9326
07/08/2025 03:34:26 - INFO - __main__ -     eval_precision = 0.8865
07/08/2025 03:34:26 - INFO - __main__ -     eval_recall = 0.9839
07/08/2025 03:34:26 - INFO - __main__ -     eval_threshold = 0.5
07/08/2025 03:34:26 - INFO - __main__ -   Epoch 11 finished. Avg loss=0.1522
07/08/2025 03:34:26 - INFO - __main__ -   === Epoch 12/18 ===
07/08/2025 06:05:07 - INFO - __main__ -   ***** Running evaluation *****
07/08/2025 06:05:07 - INFO - __main__ -     Num examples = 2000
07/08/2025 06:05:07 - INFO - __main__ -     Batch size = 16
07/08/2025 06:09:45 - INFO - __main__ -   ***** Eval results *****
07/08/2025 06:09:45 - INFO - __main__ -     eval_accuracy = 0.9165
07/08/2025 06:09:45 - INFO - __main__ -     eval_f1 = 0.9125
07/08/2025 06:09:45 - INFO - __main__ -     eval_precision = 0.9498
07/08/2025 06:09:45 - INFO - __main__ -     eval_recall = 0.878
07/08/2025 06:09:45 - INFO - __main__ -     eval_threshold = 0.5
07/08/2025 06:09:45 - INFO - __main__ -   Epoch 12 finished. Avg loss=0.1498
07/08/2025 06:09:45 - INFO - __main__ -   === Epoch 13/18 ===
07/08/2025 08:40:23 - INFO - __main__ -   ***** Running evaluation *****
07/08/2025 08:40:23 - INFO - __main__ -     Num examples = 2000
07/08/2025 08:40:23 - INFO - __main__ -     Batch size = 16
07/08/2025 08:45:02 - INFO - __main__ -   ***** Eval results *****
07/08/2025 08:45:02 - INFO - __main__ -     eval_accuracy = 0.9175
07/08/2025 08:45:02 - INFO - __main__ -     eval_f1 = 0.9129
07/08/2025 08:45:02 - INFO - __main__ -     eval_precision = 0.9579
07/08/2025 08:45:02 - INFO - __main__ -     eval_recall = 0.872
07/08/2025 08:45:02 - INFO - __main__ -     eval_threshold = 0.5
07/08/2025 08:45:02 - INFO - __main__ -   Epoch 13 finished. Avg loss=0.1361
07/08/2025 08:45:02 - INFO - __main__ -   === Epoch 14/18 ===
07/08/2025 11:15:38 - INFO - __main__ -   ***** Running evaluation *****
07/08/2025 11:15:38 - INFO - __main__ -     Num examples = 2000
07/08/2025 11:15:38 - INFO - __main__ -     Batch size = 16
07/08/2025 11:20:16 - INFO - __main__ -   ***** Eval results *****
07/08/2025 11:20:16 - INFO - __main__ -     eval_accuracy = 0.8655
07/08/2025 11:20:16 - INFO - __main__ -     eval_f1 = 0.8493
07/08/2025 11:20:16 - INFO - __main__ -     eval_precision = 0.9559
07/08/2025 11:20:16 - INFO - __main__ -     eval_recall = 0.7641
07/08/2025 11:20:16 - INFO - __main__ -     eval_threshold = 0.5
07/08/2025 11:20:16 - INFO - __main__ -   Epoch 14 finished. Avg loss=0.1218
07/08/2025 11:20:16 - INFO - __main__ -   === Epoch 15/18 ===
07/08/2025 13:50:51 - INFO - __main__ -   ***** Running evaluation *****
07/08/2025 13:50:51 - INFO - __main__ -     Num examples = 2000
07/08/2025 13:50:51 - INFO - __main__ -     Batch size = 16
07/08/2025 13:55:29 - INFO - __main__ -   ***** Eval results *****
07/08/2025 13:55:29 - INFO - __main__ -     eval_accuracy = 0.9415
07/08/2025 13:55:29 - INFO - __main__ -     eval_f1 = 0.9414
07/08/2025 13:55:29 - INFO - __main__ -     eval_precision = 0.9353
07/08/2025 13:55:29 - INFO - __main__ -     eval_recall = 0.9476
07/08/2025 13:55:29 - INFO - __main__ -     eval_threshold = 0.5
07/08/2025 13:55:29 - INFO - __main__ -     ********************
07/08/2025 13:55:29 - INFO - __main__ -     Best eval_f1: 0.9414
07/08/2025 13:55:29 - INFO - __main__ -     ********************
07/08/2025 13:56:15 - INFO - __main__ -   Saved full checkpoint to ./saved_model/checkpoint-best-f1/vulllama_b4_non_pretrained.pt
07/08/2025 13:56:15 - INFO - __main__ -   Epoch 15 finished. Avg loss=0.1162
07/08/2025 13:56:15 - INFO - __main__ -   === Epoch 16/18 ===
